<!DOCTYPE html>
<html lang="my">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Myanmar TTS Pro</title>
    <style>
        body { font-family: sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f0f2f5; }
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #1a73e8; margin-bottom: 20px; }
        .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }
        
        label { display: block; margin-top: 15px; font-weight: bold; color: #444; font-size: 0.9em; }
        select, textarea, input[type="range"] { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; }
        button { width: 100%; background: #1a73e8; color: white; padding: 14px; border: none; border-radius: 6px; font-size: 1rem; cursor: pointer; margin-top: 25px; font-weight: bold; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        
        .result-box { margin-top: 25px; padding: 20px; background: #e8f0fe; border-radius: 8px; display: none; text-align: center; }
        .download-btn { display: inline-block; background: #34a853; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="card">
        <h2>·Äô·Äº·Äî·Ä∫·Äô·Ä¨ TTS (Audio & SRT)</h2>
        <div class="grid">
            <div>
                <label>Voice (·Ä°·Äû·Ä∂)</label>
                <select id="voice">
                    <option value="my-MM-ThihaNeural">·Ä°·ÄÄ·Ä≠·ÄØ·Äú·Ä±·Ä∏ (Male)</option>
                    <option value="my-MM-NilarNeural">·Äô·Äº·Äô·Äº (Female)</option>
                    <option value="en-GB-SoniaNeural">English UK (Female)</option>
                </select>

                <label>Platform (SRT ·Äï·ÄØ·Ä∂·ÄÖ·Ä∂)</label>
                <select id="platform">
                    <option value="TikTok">TikTok (9:16) - ·ÄÖ·Ä¨·Äê·Ä≠·ÄØ</option>
                    <option value="YouTube">YouTube (16:9) - ·ÄÖ·Ä¨·Äõ·Äæ·Ää·Ä∫</option>
                </select>

                <label>Speed: <span id="sVal">20</span>%</label>
                <input type="range" id="speed" min="-50" max="50" value="20" oninput="document.getElementById('sVal').innerText=this.value">

                <label>Pitch: <span id="pVal">13</span>Hz</label>
                <input type="range" id="pitch" min="-50" max="50" value="13" oninput="document.getElementById('pVal').innerText=this.value">
            </div>
            <div>
                <label>·ÄÖ·Ä¨·Äõ·Ä≠·ÄØ·ÄÄ·Ä∫·Äë·Ää·Ä∑·Ä∫·Äï·Ä´ (Script)</label>
                <textarea id="text" rows="6" placeholder="·Äô·ÄÑ·Ä∫·Äπ·ÄÇ·Äú·Ä¨·Äï·Ä´..."></textarea>

                <label>·Ä°·Äû·Ä∂·Äë·ÄΩ·ÄÄ·Ä∫ ·Äï·Äº·ÄÑ·Ä∫·ÄÜ·ÄÑ·Ä∫·Äõ·Äî·Ä∫ (Rules)</label>
                <textarea id="rules" rows="4">
·Äô·Ä±·Äê·Äπ·Äê·Ä¨ = ·Äô·Äº·ÄÖ·Ä∫·Äê·Ä¨
·Äû·ÄÖ·Äπ·ÄÖ·Ä¨ = ·Äû·ÄÖ·Ä∫·ÄÖ·Ä¨
·Äï·Äº·Äø·Äî·Ä¨ = ·Äï·Äº·Äê·Ä∫·Äû·Äî·Ä¨</textarea>
            </div>
        </div>

        <button id="btn" onclick="generate()">üöÄ Generate Audio</button>
        <p id="status" style="text-align: center; color: #666; margin-top: 10px; display: none;">Generating... ·ÄÅ·Äè·ÄÖ·Ä±·Ä¨·ÄÑ·Ä∑·Ä∫·Äï·Ä´...</p>

        <div id="result" class="result-box">
            <audio id="player" controls style="width: 100%"></audio>
            <br>
            <a id="dlSrt" class="download-btn">SRT ·Äñ·Ä≠·ÄØ·ÄÑ·Ä∫ ·Äí·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·Äõ·Äî·Ä∫</a>
        </div>
    </div>

    <script>
        async function generate() {
            const btn = document.getElementById('btn');
            const status = document.getElementById('status');
            const result = document.getElementById('result');
            
            btn.disabled = true;
            status.style.display = 'block';
            result.style.display = 'none';

            try {
                const res = await fetch('/api', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        text: document.getElementById('text').value,
                        rules: document.getElementById('rules').value,
                        voice: document.getElementById('voice').value,
                        platform: document.getElementById('platform').value,
                        speed: document.getElementById('speed').value,
                        pitch: document.getElementById('pitch').value
                    })
                });
                const data = await res.json();
                
                if (data.error) throw new Error(data.error);

                // Audio Setup
                const audioBlob = await (await fetch("data:audio/mp3;base64," + data.audio)).blob();
                document.getElementById('player').src = URL.createObjectURL(audioBlob);

                // SRT Setup
                const srtBlob = new Blob([data.srt], {type: "text/plain"});
                const srtLink = document.getElementById('dlSrt');
                srtLink.href = URL.createObjectURL(srtBlob);
                srtLink.download = "subtitle.srt";

                result.style.display = 'block';
            } catch (e) {
                alert("Error: " + e.message);
            } finally {
                btn.disabled = false;
                status.style.display = 'none';
            }
        }
    </script>
</body>
</html>

